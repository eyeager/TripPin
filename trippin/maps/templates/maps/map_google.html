{% extends "trippin/base.html" %}
{% block head %}
	{% load static %}

	<style type="text/css">
	  html, body { height: 100%; margin: 0; padding: 0; }
	  #map { height: 100%; }
	</style>

{% endblock %}

{% block content %}
    <div id="map"></div>

    <script type="text/javascript">
	    var map;

		function initMap() {
			var styles = [
			  {
			    "stylers": [
			      { "hue": "#00d4ff" },
			      { "saturation": 31 }
			    ]
			  },{
			    "featureType": "landscape.natural",
			    "stylers": [
			      { "lightness": -5 }
			    ]
			  },{
			    "featureType": "water",
			    "stylers": [
			      { "visibility": "on" },
			      // { "hue": "#00d4ff" },
			      { "lightness": 50}
			    ]
			  },{
			    "featureType": "road",
			    "elementType": "geometry",
			    "stylers": [
			      { "lightness": 88 }
			    ]
			  }
			]

			var styledMap = new google.maps.StyledMapType(styles,
				{name: "Styled Map"});

			// Create a map object, and include the MapTypeId to add
			// to the map type control.
			var mapOptions = {
				zoom: 2,
				center: new google.maps.LatLng(19.158203, -6.345867),
				mapTypeControlOptions: {
				  mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']
				}
			};

			var map = new google.maps.Map(document.getElementById('map'), mapOptions);

			map.mapTypes.set('map_style', styledMap);
			map.setMapTypeId('map_style');

			setMarkers(map);

			// map.addListener('center_changed', function() {
		 //    // 3 seconds after the center of the map has changed, pan back to the
		 //    // marker.
		 //    window.setTimeout(function() {
			// 	map.panTo(marker.getPosition());
			// 	}, 3000);
			// });


		}

		function setMarkers(map) {
			var pin_data = {{pin_data|safe}}
			for (var checkin in pin_data) 
			{
				var marker = new google.maps.Marker({
					position: {lat: parseFloat(pin_data[checkin]["lat"]), lng: parseFloat(pin_data[checkin]['lng'])},
					map: map,
					title: pin_data[checkin]["title"],
				});

				var contentString = pin_data[checkin]["description"]

				var infowindow = new google.maps.InfoWindow({
					content: contentString
				});

				marker.addListener('click', function() {
					infowindow.open(map, marker);
				});

				marker.addListener('click', function() {
					map.setZoom(13);
					map.setCenter(marker.getPosition());
				},false);

			}

		}
    </script>

    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlnWYA_t9C664izZ17518gmMRLT_HhHJ4&callback=initMap">
    </script>

{% endblock %}